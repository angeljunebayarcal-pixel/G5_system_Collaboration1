<div class="content-wrapper">

  <h1 class="page-title">Barangay Official</h1>

  <!-- NOTIFICATION POPUP -->
  <div *ngIf="notificationMessage" class="popup">
    {{ notificationMessage }}
  </div>

  <!-- PENDING APPOINTMENTS -->
  <div class="card">
    <h2 class="section-title">Pending Appointments</h2>
    <div class="request-list">

      <div class="request-item" *ngFor="let app of pendingAppointments">
        <span class="request-text">
          Resident ID: {{ app.residentId }} 
          | Date: {{ app.details.date || 'Not set' }} 
          | Time: {{ app.details.time || 'Not set' }} 
          | Description: {{ app.details.description || 'No description' }}
        </span>

        <div class="actions">
          <button class="reschedule" (click)="openReschedule(app.id)">Reschedule</button>
          <button class="approve" (click)="approveAppointment(app.id)">Approve</button>
          <button class="decline" (click)="cancelAppointment(app.id)">Decline</button>
        </div>
      </div>

      <div *ngIf="pendingAppointments.length === 0" class="no-requests">
        No pending appointments.
      </div>
    </div>
  </div>

  <!-- PENDING CERTIFICATE REQUESTS -->
  <div class="card">
    <h2 class="section-title">Pending Certificate Requests</h2>
    <div class="request-list">

      <div class="request-item" *ngFor="let cert of pendingCertificates">
        <span class="request-text">
          Resident ID: {{ cert.residentId }} 
          | Certificate: {{ cert.details.type || 'Not set' }} 
          | Purpose: {{ cert.details.purpose || 'No purpose' }} 
          | Date: {{ cert.details.date || 'Not set' }} 
          | Time: {{ cert.details.time || 'Not set' }}
        </span>

        <div class="actions">
          <button class="reschedule" (click)="openCertificateReschedule(cert.id)">Reschedule</button>
          <button class="approve" (click)="approveCertificate(cert.id)">Approve</button>
          <button class="decline" (click)="cancelCertificate(cert.id)">Decline</button>
        </div>
      </div>

      <div *ngIf="pendingCertificates.length === 0" class="no-requests">
        No pending certificate requests.
      </div>
    </div>
  </div>

</div>

<!-- RESCHEDULE MODAL FOR APPOINTMENTS -->
<div class="modal-overlay" *ngIf="showAppointmentModal">
  <div class="modal">
    <h3>Reschedule Appointment</h3>
    <label>New Date:</label>
    <input type="date" [(ngModel)]="newDate">
    <label>New Time:</label>
    <input type="time" [(ngModel)]="newTime">

    <div class="modal-actions">
      <button class="save" (click)="saveReschedule()">Save</button>
      <button class="cancel" (click)="closeRescheduleModal()">Cancel</button>
    </div>
  </div>
</div>

<!-- RESCHEDULE MODAL FOR CERTIFICATE REQUESTS -->
<div class="modal-overlay" *ngIf="showCertificateModal">
  <div class="modal">
    <h3>Reschedule Certificate Request</h3>
    <label>New Date:</label>
    <input type="date" [(ngModel)]="newCertDate">
    <label>New Time:</label>
    <input type="time" [(ngModel)]="newCertTime">

    <div class="modal-actions">
      <button class="save" (click)="saveCertificateReschedule()">Save</button>
      <button class="cancel" (click)="closeCertificateModal()">Cancel</button>
    </div>
  </div>
</div>